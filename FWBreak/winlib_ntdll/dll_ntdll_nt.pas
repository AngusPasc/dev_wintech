(*
         86   4E 0000CE5E NtAcceptConnectPort
         87   4F 0000CE6E NtAccessCheck
         88   50 0000CE7E NtAccessCheckAndAuditAlarm
         89   51 0000CE8E NtAccessCheckByType
         90   52 0000CE9E NtAccessCheckByTypeAndAuditAlarm
         91   53 0000CEAE NtAccessCheckByTypeResultList
         92   54 0000CEBE NtAccessCheckByTypeResultListAndAuditAlarm
         93   55 0000CECE NtAccessCheckByTypeResultListAndAuditAlarmByHandle
         94   56 0000CEDE NtAddAtom
         95   57 0000CEEE NtAddBootEntry
         96   58 0000CEFE NtAdjustGroupsToken
         97   59 0000CF0E NtAdjustPrivilegesToken
         98   5A 0000CF1E NtAlertResumeThread
         99   5B 0000CF2E NtAlertThread
        100   5C 0000CF3E NtAllocateLocallyUniqueId
        101   5D 0000CF4E NtAllocateUserPhysicalPages
        102   5E 0000CF5E NtAllocateUuids
        103   5F 0000CF6E NtAllocateVirtualMemory
        104   60 0000CF7E NtAreMappedFilesTheSame
        105   61 0000CF8E NtAssignProcessToJobObject
        106   62 0000CF9E NtCallbackReturn
        107   63 0000CFAE NtCancelDeviceWakeupRequest
        108   64 0000CFBE NtCancelIoFile
        109   65 0000CFCE NtCancelTimer
        110   66 0000CFDE NtClearEvent
        111   67 0000CFEE NtClose
        112   68 0000CFFE NtCloseObjectAuditAlarm
        113   69 0000D00E NtCompactKeys
        114   6A 0000D01E NtCompareTokens
        115   6B 0000D02E NtCompleteConnectPort
        116   6C 0000D03E NtCompressKey
        117   6D 0000D04E NtConnectPort
        118   6E 0000D05E NtContinue
        119   6F 0000D06E NtCreateDebugObject
        120   70 0000D07E NtCreateDirectoryObject
        121   71 0000D08E NtCreateEvent
        122   72 0000D09E NtCreateEventPair
        123   73 0000D0AE NtCreateFile
        124   74 0000D0BE NtCreateIoCompletion
        125   75 0000D0CE NtCreateJobObject
        126   76 0000D0DE NtCreateJobSet
        127   77 0000D0EE NtCreateKey
        128   78 0000DFCE NtCreateKeyedEvent
        129   79 0000D0FE NtCreateMailslotFile
        130   7A 0000D10E NtCreateMutant
        131   7B 0000D11E NtCreateNamedPipeFile
        132   7C 0000D12E NtCreatePagingFile
        133   7D 0000D13E NtCreatePort
        134   7E 0000D14E NtCreateProcess
        135   7F 0000D15E NtCreateProcessEx
        136   80 0000D16E NtCreateProfile
        137   81 0000D17E NtCreateSection
        138   82 0000D18E NtCreateSemaphore
        139   83 0000D19E NtCreateSymbolicLinkObject
        140   84 0000D1AE NtCreateThread
        141   85 0000D1BE NtCreateTimer
        142   86 0000D1CE NtCreateToken
        143   87 0000D1DE NtCreateWaitablePort
        144   88 0000121E NtCurrentTeb
        145   89 0000D1EE NtDebugActiveProcess
        146   8A 0000D1FE NtDebugContinue
        147   8B 0000D20E NtDelayExecution
        148   8C 0000D21E NtDeleteAtom
        149   8D 0000D22E NtDeleteBootEntry
        150   8E 0000D23E NtDeleteFile
        151   8F 0000D24E NtDeleteKey
        152   90 0000D25E NtDeleteObjectAuditAlarm
        153   91 0000D26E NtDeleteValueKey
        154   92 0000D27E NtDeviceIoControlFile
        155   93 0000D28E NtDisplayString
        156   94 0000D29E NtDuplicateObject
        157   95 0000D2AE NtDuplicateToken
        158   96 0000D2BE NtEnumerateBootEntries
        159   97 0000D2CE NtEnumerateKey
        160   98 0000D2DE NtEnumerateSystemEnvironmentValuesEx
        161   99 0000D2EE NtEnumerateValueKey
        162   9A 0000D2FE NtExtendSection
        163   9B 0000D30E NtFilterToken
        164   9C 0000D31E NtFindAtom
        165   9D 0000D32E NtFlushBuffersFile
        166   9E 0000D33E NtFlushInstructionCache
        167   9F 0000D34E NtFlushKey
        168   A0 0000D35E NtFlushVirtualMemory
        169   A1 0000D36E NtFlushWriteBuffer
        170   A2 0000D37E NtFreeUserPhysicalPages
        171   A3 0000D38E NtFreeVirtualMemory
        172   A4 0000D39E NtFsControlFile
        173   A5 0000D3AE NtGetContextThread
        174   A6 0000D3BE NtGetDevicePowerState
        175   A7 0000D3CE NtGetPlugPlayEvent
        176   A8 0000D3DE NtGetWriteWatch
        177   A9 0000D3EE NtImpersonateAnonymousToken
        178   AA 0000D3FE NtImpersonateClientOfPort
        179   AB 0000D40E NtImpersonateThread
        180   AC 0000D41E NtInitializeRegistry
        181   AD 0000D42E NtInitiatePowerAction
        182   AE 0000D43E NtIsProcessInJob
        183   AF 0000D44E NtIsSystemResumeAutomatic
        184   B0 0000D45E NtListenPort
        185   B1 0000D46E NtLoadDriver
        187   B2 0000D47E NtLoadKey
        186   B3 0000D48E NtLoadKey2
        188   B4 0000D49E NtLockFile
        189   B5 0000D4AE NtLockProductActivationKeys
        190   B6 0000D4BE NtLockRegistryKey
        191   B7 0000D4CE NtLockVirtualMemory
        192   B8 0000D4DE NtMakePermanentObject
        193   B9 0000D4EE NtMakeTemporaryObject
        194   BA 0000D4FE NtMapUserPhysicalPages
        195   BB 0000D50E NtMapUserPhysicalPagesScatter
        196   BC 0000D51E NtMapViewOfSection
        197   BD 0000D52E NtModifyBootEntry
        198   BE 0000D53E NtNotifyChangeDirectoryFile
        199   BF 0000D54E NtNotifyChangeKey
        200   C0 0000D55E NtNotifyChangeMultipleKeys
        201   C1 0000D56E NtOpenDirectoryObject
        202   C2 0000D57E NtOpenEvent
        203   C3 0000D58E NtOpenEventPair
        204   C4 0000D59E NtOpenFile
        205   C5 0000D5AE NtOpenIoCompletion
        206   C6 0000D5BE NtOpenJobObject
        207   C7 0000D5CE NtOpenKey
        208   C8 0000DFDE NtOpenKeyedEvent
        209   C9 0000D5DE NtOpenMutant
        210   CA 0000D5EE NtOpenObjectAuditAlarm
        211   CB 0000D5FE NtOpenProcess
        212   CC 0000D60E NtOpenProcessToken
        213   CD 0000D61E NtOpenProcessTokenEx
        214   CE 0000D62E NtOpenSection
        215   CF 0000D63E NtOpenSemaphore
        216   D0 0000D64E NtOpenSymbolicLinkObject
        217   D1 0000D65E NtOpenThread
        218   D2 0000D66E NtOpenThreadToken
        219   D3 0000D67E NtOpenThreadTokenEx
        220   D4 0000D68E NtOpenTimer
        221   D5 0000D69E NtPlugPlayControl
        222   D6 0000D6AE NtPowerInformation
        223   D7 0000D6BE NtPrivilegeCheck
        224   D8 0000D6CE NtPrivilegeObjectAuditAlarm
        225   D9 0000D6DE NtPrivilegedServiceAuditAlarm
        226   DA 0000D6EE NtProtectVirtualMemory
        227   DB 0000D6FE NtPulseEvent
        228   DC 0000D70E NtQueryAttributesFile
        229   DD 0000D71E NtQueryBootEntryOrder
        230   DE 0000D72E NtQueryBootOptions
        231   DF 0000D73E NtQueryDebugFilterState
        232   E0 0000D74E NtQueryDefaultLocale
        233   E1 0000D75E NtQueryDefaultUILanguage
        234   E2 0000D76E NtQueryDirectoryFile
        235   E3 0000D77E NtQueryDirectoryObject
        236   E4 0000D78E NtQueryEaFile
        237   E5 0000D79E NtQueryEvent
        238   E6 0000D7AE NtQueryFullAttributesFile
        239   E7 0000D7BE NtQueryInformationAtom
        240   E8 0000D7CE NtQueryInformationFile
        241   E9 0000D7DE NtQueryInformationJobObject
        242   EA 0000D7EE NtQueryInformationPort
        243   EB 0000D7FE NtQueryInformationProcess
        244   EC 0000D80E NtQueryInformationThread
        245   ED 0000D81E NtQueryInformationToken
        246   EE 0000D82E NtQueryInstallUILanguage
        247   EF 0000D83E NtQueryIntervalProfile
        248   F0 0000D84E NtQueryIoCompletion
        249   F1 0000D85E NtQueryKey
        250   F2 0000D86E NtQueryMultipleValueKey
        251   F3 0000D87E NtQueryMutant
        252   F4 0000D88E NtQueryObject
        253   F5 0000D89E NtQueryOpenSubKeys
        254   F6 0000D8AE NtQueryPerformanceCounter
        255   F7 0000E00E NtQueryPortInformationProcess
        256   F8 0000D8BE NtQueryQuotaInformationFile
        257   F9 0000D8CE NtQuerySection
        258   FA 0000D8DE NtQuerySecurityObject
        259   FB 0000D8EE NtQuerySemaphore
        260   FC 0000D8FE NtQuerySymbolicLinkObject
        261   FD 0000D90E NtQuerySystemEnvironmentValue
        262   FE 0000D91E NtQuerySystemEnvironmentValueEx
        263   FF 0000D92E NtQuerySystemInformation
        264  100 0000D93E NtQuerySystemTime
        265  101 0000D94E NtQueryTimer
        266  102 0000D95E NtQueryTimerResolution
        267  103 0000D96E NtQueryValueKey
        268  104 0000D97E NtQueryVirtualMemory
        269  105 0000D98E NtQueryVolumeInformationFile
        270  106 0000D99E NtQueueApcThread
        271  107 0000D9AE NtRaiseException
        272  108 0000D9BE NtRaiseHardError
        273  109 0000D9CE NtReadFile
        274  10A 0000D9DE NtReadFileScatter
        275  10B 0000D9EE NtReadRequestData
        276  10C 0000D9FE NtReadVirtualMemory
        277  10D 0000DA0E NtRegisterThreadTerminatePort
        278  10E 0000DFEE NtReleaseKeyedEvent
        279  10F 0000DA1E NtReleaseMutant
        280  110 0000DA2E NtReleaseSemaphore
        281  111 0000DA3E NtRemoveIoCompletion
        282  112 0000DA4E NtRemoveProcessDebug
        283  113 0000DA5E NtRenameKey
        284  114 0000DA6E NtReplaceKey
        285  115 0000DA7E NtReplyPort
        286  116 0000DA8E NtReplyWaitReceivePort
        287  117 0000DA9E NtReplyWaitReceivePortEx
        288  118 0000DAAE NtReplyWaitReplyPort
        289  119 0000DABE NtRequestDeviceWakeup
        290  11A 0000DACE NtRequestPort
        291  11B 0000DADE NtRequestWaitReplyPort
        292  11C 0000DAEE NtRequestWakeupLatency
        293  11D 0000DAFE NtResetEvent
        294  11E 0000DB0E NtResetWriteWatch
        295  11F 0000DB1E NtRestoreKey
        296  120 0000DB2E NtResumeProcess
        297  121 0000DB3E NtResumeThread
        298  122 0000DB4E NtSaveKey
        299  123 0000DB5E NtSaveKeyEx
        300  124 0000DB6E NtSaveMergedKeys
        301  125 0000DB7E NtSecureConnectPort
        302  126 0000DB8E NtSetBootEntryOrder
        303  127 0000DB9E NtSetBootOptions
        304  128 0000DBAE NtSetContextThread
        305  129 0000DBBE NtSetDebugFilterState
        306  12A 0000DBCE NtSetDefaultHardErrorPort
        307  12B 0000DBDE NtSetDefaultLocale
        308  12C 0000DBEE NtSetDefaultUILanguage
        309  12D 0000DBFE NtSetEaFile
        310  12E 0000DC0E NtSetEvent
        311  12F 0000DC1E NtSetEventBoostPriority
        312  130 0000DC2E NtSetHighEventPair
        313  131 0000DC3E NtSetHighWaitLowEventPair
        314  132 0000DC4E NtSetInformationDebugObject
        315  133 0000DC5E NtSetInformationFile
        316  134 0000DC6E NtSetInformationJobObject
        317  135 0000DC7E NtSetInformationKey
        318  136 0000DC8E NtSetInformationObject
        319  137 0000DC9E NtSetInformationProcess
        320  138 0000DCAE NtSetInformationThread
        321  139 0000DCBE NtSetInformationToken
        322  13A 0000DCCE NtSetIntervalProfile
        323  13B 0000DCDE NtSetIoCompletion
        324  13C 0000DCEE NtSetLdtEntries
        325  13D 0000DCFE NtSetLowEventPair
        326  13E 0000DD0E NtSetLowWaitHighEventPair
        327  13F 0000DD1E NtSetQuotaInformationFile
        328  140 0000DD2E NtSetSecurityObject
        329  141 0000DD3E NtSetSystemEnvironmentValue
        330  142 0000DD4E NtSetSystemEnvironmentValueEx
        331  143 0000DD5E NtSetSystemInformation
        332  144 0000DD6E NtSetSystemPowerState
        333  145 0000DD7E NtSetSystemTime
        334  146 0000DD8E NtSetThreadExecutionState
        335  147 0000DD9E NtSetTimer
        336  148 0000DDAE NtSetTimerResolution
        337  149 0000DDBE NtSetUuidSeed
        338  14A 0000DDCE NtSetValueKey
        339  14B 0000DDDE NtSetVolumeInformationFile
        340  14C 0000DDEE NtShutdownSystem
        341  14D 0000DDFE NtSignalAndWaitForSingleObject
        342  14E 0000DE0E NtStartProfile
        343  14F 0000DE1E NtStopProfile
        344  150 0000DE2E NtSuspendProcess
        345  151 0000DE3E NtSuspendThread
        346  152 0000DE4E NtSystemDebugControl
        347  153 0000DE5E NtTerminateJobObject
        348  154 0000DE6E NtTerminateProcess
        349  155 0000DE7E NtTerminateThread
        350  156 0000DE8E NtTestAlert
        351  157 0000DE9E NtTraceEvent
        352  158 0000DEAE NtTranslateFilePath
        353  159 0000DEBE NtUnloadDriver
        354  15A 0000DECE NtUnloadKey
        355  15B 0000DEDE NtUnloadKeyEx
        356  15C 0000DEEE NtUnlockFile
        357  15D 0000DEFE NtUnlockVirtualMemory
        358  15E 0000DF0E NtUnmapViewOfSection
        359  15F 0000DF1E NtVdmControl
        360  160 0000DF2E NtWaitForDebugEvent
        361  161 0000DFFE NtWaitForKeyedEvent
        362  162 0000DF3E NtWaitForMultipleObjects
        363  163 0000DF4E NtWaitForSingleObject
        364  164 0000DF5E NtWaitHighEventPair
        365  165 0000DF6E NtWaitLowEventPair
        366  166 0000DF7E NtWriteFile
        367  167 0000DF8E NtWriteFileGather
        368  168 0000DF9E NtWriteRequestData
        369  169 0000DFAE NtWriteVirtualMemory
        370  16A 0000DFBE NtYieldExecution
*)

unit dll_ntdll_nt;

interface
                     
uses
  atmcmbaseconst, winconst, wintype;

type                              
  TProcessInfoClass = (
    ProcessBasicInformation,
    ProcessQuotaLimits,
    ProcessIoCounters,
    ProcessVmCounters,
    ProcessTimes,
    ProcessBasePriority,
    ProcessRaisePriority,
    ProcessDebugPort,
    ProcessExceptionPort,
    ProcessAccessToken,
    ProcessLdtInformation,
    ProcessLdtSize,
    ProcessDefaultHardErrorMode,
    ProcessIoPortHandlers, // Note: this is kernel mode only
    ProcessPooledUsageAndLimits,
    ProcessWorkingSetWatch,
    ProcessUserModeIOPL,
    ProcessEnableAlignmentFaultFixup,
    ProcessPriorityClass,
    ProcessWx86Information,
    ProcessHandleCount,
    ProcessAffinityMask,
    ProcessPriorityBoost,
    ProcessDeviceMap,
    ProcessSessionInformation,
    ProcessForegroundInformation,
    ProcessWow64Information, // = 26
    ProcessImageFileName, // = 27 added after W2K
    ProcessLUIDDeviceMapsEnabled,
    ProcessBreakOnTermination, // used by RtlSetProcessIsCritical()
    ProcessDebugObjectHandle,
    ProcessDebugFlags,
    ProcessHandleTracing,
    MaxProcessInfoClass);

//  USHORT              = Word;
  TUnicodeString      = packed Record
    Length            : Word;
    MaximumLength     : Word;
    Buffer            : PWideString;
  end;

  TRtlUserProcessParameters = packed record
    Reserved1         : array[0..15] of Byte;
    Reserved2         : array[0..9] of Pointer;
    ImagePathName     : TUnicodeString;
    CommandLine       : TUnicodeString;
  end;
  PRtlUserProcessParameters = ^TRtlUserProcessParameters;

  TPEB                = packed record
    Reserved1         : array[0..1] of Byte;
    BeingDebugged     : ByteBool;
    Reserved2         : Byte;
    Reserved3         : array[0..1] of Pointer;
    Ldr               : Pointer;
    ProcessParameters : PRtlUserProcessParameters;
    Reserved4         : array[0..103]of Byte;
    Reserved5         : array[0..51]of Pointer;
  end;
  PPEB                = ^TPEB;

  TProcessBasicInformation = packed record
    ExitStatus        : DWORD;
    PebBaseAddress    : PPEB;
    AffinityMask      : DWORD;
    BasePriority      : DWORD;
    uUniqueProcessId  : ULong;
    uInheritedFromUniqueProcessId: ULong;
  end;

  function  NtQueryInformationProcess(
      ProcessHandle : THandle;
      ProcessInformationClass : TProcessInfoClass;
      ProcessInformation : Pointer;
      ProcessInformationLength : ULONG;
      ReturnLength : PULONG
    ): NTSTATUS; stdcall; external ntdll;

type
  TThreadInfoClass = (
    ThreadBasicInformation,
    ThreadTimes,
    ThreadPriority,
    ThreadBasePriority,
    ThreadAffinityMask,
    ThreadImpersonationToken,
    ThreadDescriptorTableEntry,
    ThreadEnableAlignmentFaultFixup,
    ThreadEventPair_Reusable,
    ThreadQuerySetWin32StartAddress,
    ThreadZeroTlsCell,
    ThreadPerformanceCount,
    ThreadAmILastThread,
    ThreadIdealProcessor,
    ThreadPriorityBoost,
    ThreadSetTlsArrayAddress,
    ThreadIsIoPending,
    ThreadHideFromDebugger,
    ThreadBreakOnTermination, // was added in XP - used by RtlSetThreadIsCritical()
    MaxThreadInfoClass);

  function  NtQueryInformationThread(
      ThreadHandle : THandle;
      ThreadInformationClass : TThreadInfoClass;
      ThreadInformation : Pointer; // PVOID
      ThreadInformationLength : ULONG;
      ReturnLength : PULONG
    ): NTSTATUS; stdcall; external ntdll;

implementation

end.
