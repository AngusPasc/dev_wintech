(*
        208    0 0022F584 AppCompat_RunDLLW
        226    1 0002AD12 AssocCreateForClasses
        228    2 000957BC AssocGetDetailsOfPropKey
        701    3 002334E5 CDefFolderMenu_Create2
         83    4 002337DD CIDLData_CreateFromIDArray
        229    5 00234900 CheckEscapesW
        238    6 00019E66 CommandLineToArgvW
        255    7 00238680 Control_RunDLL
        263    8 00238680 Control_RunDLLA
        267    9 0023865F Control_RunDLLAsUserW
        268    A 000D4CB1 Control_RunDLLW
        129    B 00086485 DAD_AutoScroll
        131    C 0015F2BC DAD_DragEnterEx
         22    D 0023C23D DAD_DragEnterEx2
        132    E 0023A3F7 DAD_DragLeave
        134    F 0023B3DA DAD_DragMove
        136   10 000A7915 DAD_SetDragImage
        137   11 000B4B5D DAD_ShowDragImage
        269   12 000B97C9 DllCanUnloadNow
        271   13 000B2521 DllGetClassObject
        272   14 00378648 DllGetVersion
        273   15 0023E7A3 DllInstall
        274   16 0007D71D DllRegisterServer
        275   17 0007D71D DllUnregisterServer
        276   18 002083F6 DoEnvironmentSubstA
        277   19 00012ECB DoEnvironmentSubstW
        278   1A 00119845 DragAcceptFiles
        279   1B 002182D7 DragFinish
        280   1C 0021853E DragQueryFile
        281   1D 0021853E DragQueryFileA
        282   1E 002182E8 DragQueryFileAorW
        283   1F 0021851B DragQueryFileW
        284   20 00218274 DragQueryPoint
         64   21 0009DAB9 DriveType
        285   22 00207D8C DuplicateIcon
        286   23 002082DE ExtractAssociatedIconA
        287   24 00208133 ExtractAssociatedIconExA
        288   25 00207EEB ExtractAssociatedIconExW
        289   26 002081FE ExtractAssociatedIconW
        290   27 00208288 ExtractIconA
        291   28 00207E8F ExtractIconEx
        292   29 00207E8F ExtractIconExA
        293   2A 0011724D ExtractIconExW
        294   2B 00109465 ExtractIconW
        295   2C 0024571F FindExecutableA
        296   2D 0000235D FindExecutableW
        297   2E 002FBD86 FreeIconList
        298   2F 00237B53 GetCurrentProcessExplicitAppUserModelID
         63   30 002467C7 GetFileNameFromBrowse
        154   31 00246A59 ILAppendID
         18   32 0009CA48 ILClone
         19   33 000A1921 ILCloneFirst
         25   34 0009F8CD ILCombine
        157   35 00246AE9 ILCreateFromPath
        189   36 00246B23 ILCreateFromPathA
        190   37 00246AE9 ILCreateFromPathW
         24   38 00086541 ILFindChild
         16   39 000A0A23 ILFindLastID
        155   3A 000AA239 ILFree
        153   3B 00046F39 ILGetNext
        152   3C 0009C9DA ILGetSize
         21   3D 000A38E1 ILIsEqual
         23   3E 00092489 ILIsParent
        846   3F 0005D97D ILLoadFromStreamEx
         17   40 000A24CB ILRemoveLastID
         27   41 00046F5D ILSaveToStream
        299   42 00077283 InitNetworkAddressControl
        300   43 00086485 InternalExtractIconListA
        301   44 00086485 InternalExtractIconListW
        119   45 0001A230 IsLFNDrive
         41   46 002341FF IsLFNDriveA
         42   47 0001A230 IsLFNDriveW
         66   48 000A48E9 IsNetDrive
        680   49 000531AF IsUserAnAdmin
        302   4A 00218D9F LaunchMSHelp_RunDLLW
         81   4B 0021BF99 OpenAs_RunDLL
        125   4C 0021BF99 OpenAs_RunDLLA
        133   4D 0021C036 OpenAs_RunDLLW
         85   4E 00036F8F OpenRegStream
        303   4F 00346984 Options_RunDLL
        304   50 00346984 Options_RunDLLA
        305   51 000C8FE9 Options_RunDLLW
        171   52 00114866 PathCleanupSpec
         92   53 002346FF PathGetShortPath
         43   54 0005B0CD PathIsExe
        240   55 002347FD PathIsSlowA
        239   56 00144500 PathIsSlowW
         47   57 002346D9 PathMakeUniqueName
         49   58 002342C6 PathQualify
         51   59 00016963 PathResolve
         75   5A 001149FC PathYetAnotherMakeUniqueName
         62   5B 0020EE44 PickIconDlg
         13   5C 00213E05 PifMgr_CloseProperties
         10   5D 0021470D PifMgr_GetProperties
          9   5E 002155C8 PifMgr_OpenProperties
         11   5F 0021506D PifMgr_SetProperties
        135   60 0022405E PrepareDiscForBurnRunDllW
        138   61 002263FA PrintersGetCommand_RunDLL
        139   62 002263FA PrintersGetCommand_RunDLLA
        150   63 0022647F PrintersGetCommand_RunDLLW
        654   64 0012E389 ReadCabinetState
        524   65 0009DAD1 RealDriveType
        306   66 002491ED RealShellExecuteA
        307   67 002491E2 RealShellExecuteExA
        308   68 002491E2 RealShellExecuteExW
        309   69 002491ED RealShellExecuteW
        310   6A 000BAE91 RegenerateUserEnvironment
         59   6B 0023CAF0 RestartDialog
        730   6C 0023C836 RestartDialogEx
        311   6D 00218EBF RunAsNewUser_RunDLLW
        312   6E 000EC19C SHAddDefaultPropertiesByExt
        167   6F 0024B4C0 SHAddFromPropSheetExtArray
        313   70 0011203A SHAddToRecentDocs
        196   71 00115D42 SHAlloc
        314   72 0000BA46 SHAppBarMessage
        315   73 00135043 SHAssocEnumHandlers
        316   74 000E21AE SHAssocEnumHandlersForProtocolByApplication
        317   75 000A77AB SHBindToFolderIDListParent
        318   76 000A24F5 SHBindToFolderIDListParentEx
        319   77 000A0299 SHBindToObject
        320   78 000853CF SHBindToParent
        321   79 00250756 SHBrowseForFolder
        322   7A 00250756 SHBrowseForFolderA
        323   7B 0025061E SHBrowseForFolderW
        147   7C 000849B8 SHCLSIDFromString
        644   7D 00096E86 SHChangeNotification_Lock
        645   7E 00096E62 SHChangeNotification_Unlock
        324   7F 000564B3 SHChangeNotify
          4   80 00091149 SHChangeNotifyDeregister
          2   81 00090799 SHChangeNotifyRegister
        325   82 000477E1 SHChangeNotifyRegisterThread
        326   83 00059391 SHChangeNotifySuspendResume
         89   84 0001A0E2 SHCloneSpecialIDList
        102   85 0009F62D SHCoCreateInstance
        327   86 000132AD SHCreateAssociationRegistration
        328   87 0019283C SHCreateDataObject
        329   88 0004AD26 SHCreateDefaultContextMenu
        330   89 000668E1 SHCreateDefaultExtractIcon
        331   8A 0024B306 SHCreateDefaultPropertiesOp
        165   8B 001094CC SHCreateDirectory
        332   8C 0010E57F SHCreateDirectoryExA
        333   8D 000AD1A8 SHCreateDirectoryExW
        743   8E 00248784 SHCreateFileExtractIconW
        334   8F 000A6088 SHCreateItemFromIDList
        335   90 00052C80 SHCreateItemFromParsingName
        336   91 001A226C SHCreateItemFromRelativeName
        337   92 00121DD9 SHCreateItemInKnownFolder
        338   93 00087DDB SHCreateItemWithParent
        339   94 000E2447 SHCreateLocalServerRunDll
        340   95 002491D0 SHCreateProcessAsUserW
        168   96 000D4911 SHCreatePropSheetExtArray
        341   97 000F37F5 SHCreateQueryCancelAutoPlayMoniker
        256   98 00032DB4 SHCreateShellFolderView
        174   99 0026D673 SHCreateShellFolderViewEx
        342   9A 0010CF1B SHCreateShellItem
        343   9B 0002EF7C SHCreateShellItemArray
        344   9C 0004A617 SHCreateShellItemArrayFromDataObject
        345   9D 00060D16 SHCreateShellItemArrayFromIDLists
        346   9E 0002F013 SHCreateShellItemArrayFromShellItem
         74   9F 00206FCF SHCreateStdEnumFmtEtc
          3   A0 00244EBD SHDefExtractIconA
          6   A1 00065F98 SHDefExtractIconW
        169   A2 000D49F9 SHDestroyPropSheetExtArray
         88   A3 0023C276 SHDoDragDrop
        347   A4 002712FB SHEmptyRecycleBinA
        348   A5 002712BC SHEmptyRecycleBinW
        349   A6 00012575 SHEnableServiceObject
        350   A7 0022732F SHEnumerateUnreadMailAccountsW
        351   A8 000689DE SHEvaluateSystemCommandTemplate
        352   A9 0020825B SHExtractIconsW
        353   AA 0025DAD5 SHFileOperation
        354   AB 0025DAD5 SHFileOperationA
        355   AC 00059718 SHFileOperationW
         90   AD 002287E0 SHFindFiles
        149   AE 0027203B SHFind_InitMenuPopup
        526   AF 002720AD SHFlushSFCache
        356   B0 000B3FF5 SHFormatDrive
        195   B1 000AA239 SHFree
        357   B2 00252C69 SHFreeNameMappings
        750   B3 0019352E SHGetAttributesFromDataObject
        358   B4 00247555 SHGetDataFromIDListA
        359   B5 00033ACA SHGetDataFromIDListW
        360   B6 0009CB2F SHGetDesktopFolder
        361   B7 002474F8 SHGetDiskFreeSpaceA
        362   B8 002474F8 SHGetDiskFreeSpaceExA
        363   B9 000A93D6 SHGetDiskFreeSpaceExW
        364   BA 000F36B2 SHGetDriveMedia
        365   BB 001B0A82 SHGetFileInfo
        366   BC 001B0A82 SHGetFileInfoA
        367   BD 001B0941 SHGetFileInfoW
        368   BE 0008A550 SHGetFolderLocation
        369   BF 001106A4 SHGetFolderPathA
        370   C0 0025270F SHGetFolderPathAndSubDirA
        371   C1 000426AC SHGetFolderPathAndSubDirW
        372   C2 0007CA37 SHGetFolderPathEx
        373   C3 0007CA9E SHGetFolderPathW
        374   C4 0009F9F6 SHGetIDListFromObject
        375   C5 00276E5E SHGetIconOverlayIndexA
        376   C6 00276DAE SHGetIconOverlayIndexW
        727   C7 00064AB3 SHGetImageList
        377   C8 00046744 SHGetInstanceExplorer
        378   C9 0004D805 SHGetItemFromDataObject
        379   CA 000489F9 SHGetItemFromObject
        380   CB 0008A427 SHGetKnownFolderIDList
        381   CC 0008FF24 SHGetKnownFolderItem
        382   CD 000B524D SHGetKnownFolderPath
        383   CE 00247E8A SHGetLocalizedName
        384   CF 0001FFDD SHGetMalloc
        385   D0 0002DFC0 SHGetNameFromIDList
        386   D1 00248390 SHGetNewLinkInfo
        179   D2 00248390 SHGetNewLinkInfoA
        180   D3 00248367 SHGetNewLinkInfoW
        387   D4 0001FFF6 SHGetPathFromIDList
        388   D5 0001FFF6 SHGetPathFromIDListA
        389   D6 0005C586 SHGetPathFromIDListEx
        390   D7 00094A63 SHGetPathFromIDListW
        391   D8 000AFF5D SHGetPropertyStoreForWindow
        392   D9 002478C3 SHGetPropertyStoreFromIDList
        393   DA 00247929 SHGetPropertyStoreFromParsingName
         98   DB 00010A80 SHGetRealIDL
        709   DC 0013130D SHGetSetFolderCustomSettings
         68   DD 00084D7F SHGetSetSettings
        394   DE 00277344 SHGetSettings
        395   DF 0008A679 SHGetSpecialFolderLocation
        396   E0 002526DE SHGetSpecialFolderPathA
        397   E1 0001FE7D SHGetSpecialFolderPathW
        398   E2 001A9660 SHGetStockIconInfo
        399   E3 0018F305 SHGetTemporaryPropertyForItem
        400   E4 0022A51C SHGetUnreadMailCountW
        193   E5 000E3755 SHHandleUpdateImage
        199   E6 002265CF SHHelpShortcuts_RunDLL
        206   E7 002265CF SHHelpShortcuts_RunDLLA
        207   E8 0022662A SHHelpShortcuts_RunDLLW
         28   E9 0005DD55 SHILCreateFromPath
        401   EA 0022626D SHInvokePrinterCommandA
        402   EB 00225FBF SHInvokePrinterCommandW
        403   EC 0022BE5F SHIsFileAvailableOffline
        747   ED 00278125 SHLimitInputEdit
        404   EE 0027F479 SHLoadInProc
        405   EF 002786B5 SHLoadNonloadedIconOverlayIdentifiers
         77   F0 0016232B SHMapPIDLToSystemImageListIndex
        716   F1 0027C02B SHMultiFileProperties
        178   F2 00226668 SHObjectProperties
        406   F3 002477DE SHOpenFolderAndSelectItems
         80   F4 0027BBDA SHOpenPropSheetW
        407   F5 0021BF39 SHOpenWithDialog
        408   F6 00081AC6 SHParseDisplayName
        409   F7 0027C8E3 SHPathPrepareForWriteA
        410   F8 00054781 SHPathPrepareForWriteW
        685   F9 000E1B59 SHPropStgCreate
        688   FA 000E1A5D SHPropStgReadMultiple
        689   FB 000E1700 SHPropStgWriteMultiple
        411   FC 00270981 SHQueryRecycleBinA
        412   FD 002708A3 SHQueryRecycleBinW
        413   FE 000129C2 SHQueryUserNotificationState
        414   FF 00247F37 SHRemoveLocalizedName
        170  100 0024B52C SHReplaceFromPropSheetExtArray
        415  101 00145D31 SHResolveLibrary
        100  102 0007EDCB SHRestricted
        416  103 0024B3D3 SHSetDefaultProperties
        231  104 0025267D SHSetFolderPathA
        232  105 0025250F SHSetFolderPathW
        176  106 000177BA SHSetInstanceExplorer
        417  107 0035AB3D SHSetKnownFolderPath
        418  108 0010913B SHSetLocalizedName
        419  109 001AD2DF SHSetTemporaryPropertyForItem
        420  10A 0022A731 SHSetUnreadMailCountW
         73  10B 0026D492 SHShellFolderView_Message
        421  10C 003647C0 SHShowManageLibraryUI
        162  10D 00115145 SHSimpleIDListFromPath
         14  10E 00248DB7 SHStartNetConnectionDialogW
        245  10F 00053129 SHTestTokenMembership
        191  110 002524BC SHUpdateImageA
        192  111 002522F0 SHUpdateImageW
        422  112 0000971D SHUpdateRecycleBinIcon
        173  113 0001311F SHValidateUNC
        423  114 00108544 SetCurrentProcessExplicitAppUserModelID
        424  115 00217DDD SheChangeDirA
        425  116 00217E3A SheChangeDirExW
        426  117 00217B7F SheGetDirA
        427  118 002180BD SheSetCurDrive
        428  119 0027DD79 ShellAboutA
        429  11A 000C850E ShellAboutW
        430  11B 00249D2A ShellExec_RunDLL
        431  11C 00249D2A ShellExec_RunDLLA
        432  11D 00249C38 ShellExec_RunDLLW
        433  11E 00249BAD ShellExecuteA
        434  11F 00249B12 ShellExecuteEx
        435  120 00249B12 ShellExecuteExA
        436  121 00021BCC ShellExecuteExW
        437  122 00014250 ShellExecuteW
        438  123 00086485 ShellHookProc
        183  124          ShellMessageBoxA (forwarded to shlwapi.ShellMessageBoxA)
        182  125          ShellMessageBoxW (forwarded to shlwapi.ShellMessageBoxW)
         72  126 000E17EC Shell_GetCachedImageIndex
        439  127 00244F1C Shell_GetCachedImageIndexA
        440  128 00072794 Shell_GetCachedImageIndexW
         71  129 00161946 Shell_GetImageLists
         67  12A 00048DF5 Shell_MergeMenus
        441  12B 0024B626 Shell_NotifyIcon
        442  12C 0024B626 Shell_NotifyIconA
        443  12D 000C4255 Shell_NotifyIconGetRect
        444  12E 0001FBE1 Shell_NotifyIconW
        103  12F 001646D6 SignalFileOpen
        682  130 0027EC74 StgMakeUniqueName
        469  149 00249A0D WOWShellExecute
        470  14A 0023E689 WaitForExplorerRestartW
        164  14B 0011554B Win32DeleteFile
        652  14C 0020730F WriteCabinetState
*)
unit dll_shell32;

interface 

uses
  atmcmbaseconst, winconst, wintype;
  
const
  shell32 = 'shell32.dll';

type
  PDragInfoA    = ^TDragInfoA;
  TDragInfoA    = record
    uSize       : UINT;                 { init with SizeOf(DRAGINFO) }
    pt          : TPoint;
    fNC         : BOOL;
    lpFileList  : PAnsiChar;
    grfKeyState : DWORD;
  end;

  function DragQueryFileA(ADrop: HDROP; FileIndex: UINT; FileName: PAnsiChar; cb: UINT): UINT; stdcall; external shell32 name 'DragQueryFileA';
  function DragQueryPoint(ADrop: HDROP; var Point: TPoint): BOOL; stdcall; external shell32 name 'DragQueryPoint';
  procedure DragFinish(ADrop: HDROP); stdcall; external shell32 name 'DragFinish';
  procedure DragAcceptFiles(AWnd: HWND; Accept: BOOL); stdcall; external shell32 name 'DragAcceptFiles';
  
  function ExtractIcon(AInst: HINST; lpszExeFileName: PAnsiChar; nIconIndex: UINT): HICON; stdcall; external shell32 name 'ExtractIconA';

  function ShellExecute(AWnd: HWND; Operation, FileName, Parameters, Directory: PAnsiChar; ShowCmd: Integer): HINST; stdcall; external shell32 name 'ShellExecuteA';

type
  PShellExecuteInfoA = ^TShellExecuteInfoA;
  TShellExecuteInfoA = record
    cbSize: DWORD;
    fMask: ULONG;
    Wnd: HWND;
    lpVerb: PAnsiChar;
    lpFile: PAnsiChar;
    lpParameters: PAnsiChar;
    lpDirectory: PAnsiChar;
    nShow: Integer;
    hInstApp: HINST;
    { Optional fields }
    lpIDList: Pointer;
    lpClass: PAnsiChar;
    hkeyClass: HKEY;
    dwHotKey: DWORD;
    hIcon: THandle;
    hProcess: THandle;
  end;           

  function ShellExecuteExA(lpExecInfo: PShellExecuteInfoA): BOOL; stdcall; external shell32 name 'ShellExecuteExA';

type
  PNotifyIconDataA = ^TNotifyIconDataA;
  TNotifyIconDataA = record
    cbSize: DWORD;
    Wnd: HWND;
    uID: UINT;
    uFlags: UINT;
    uCallbackMessage: UINT;
    hIcon: HICON;
    szTip: array [0..127] of AnsiChar;
    dwState: DWORD;
    dwStateMask: DWORD;
    szInfo: array [0..255] of AnsiChar;
    uTimeout: UINT;
    szInfoTitle: array [0..63] of AnsiChar;
    dwInfoFlags: DWORD;
  end;              

  function Shell_NotifyIconA(dwMessage: DWORD; lpData: PNotifyIconDataA): BOOL; stdcall; external shell32 name 'Shell_NotifyIconA';
  
type
  PAppBarData         = ^TAppBarData;
  TAppBarData         = record
    cbSize            : DWORD;
    hWnd              : HWND;
    uCallbackMessage  : UINT;
    uEdge             : UINT;
    rc                : TRect;
    lParam            : LPARAM; { message specific }
  end;

  function SHAppBarMessage(dwMessage: DWORD; var pData: TAppBarData): UINT; stdcall; external shell32 name 'SHAppBarMessage';

type           
  FILEOP_FLAGS = Word;
  
  PSHFileOpStructA = ^TSHFileOpStructA;
  TSHFileOpStructA = packed record
    Wnd: HWND;
    wFunc: UINT;
    pFrom: PAnsiChar;
    pTo: PAnsiChar;
    fFlags: FILEOP_FLAGS;
    fAnyOperationsAborted: BOOL;
    hNameMappings: Pointer;
    lpszProgressTitle: PAnsiChar; { only used if FOF_SIMPLEPROGRESS }
  end;             

  function SHFileOperationA(const lpFileOp: TSHFileOpStructA): Integer; stdcall; external shell32 name 'SHFileOperationA';

type
  PSHFileInfoA = ^TSHFileInfoA;
  TSHFileInfoA = record
    hIcon: HICON;                      { out: icon }
    iIcon: Integer;                    { out: icon index }
    dwAttributes: DWORD;               { out: SFGAO_ flags }
    szDisplayName: array [0..Windows_MAX_PATH-1] of  AnsiChar; { out: display name (or path) }
    szTypeName: array [0..79] of AnsiChar;             { out: type name }
  end;

  function SHGetFileInfoA(pszPath: PAnsiChar; dwFileAttributes: DWORD; var psfi: TSHFileInfoA;
    cbFileInfo, uFlags: UINT): DWORD; stdcall; external shell32 name 'SHGetFileInfoA';
  procedure SHFreeNameMappings(hNameMappings: THandle); stdcall; external shell32 name 'SHFreeNameMappings';
  
implementation
  
end.
